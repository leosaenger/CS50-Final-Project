{% extends "layout.html" %}

{% block title %}
    Register
{% endblock %}

{% block main %}

    <div class="container-fluid">
      <div class="row justify-content-center">
        <div class="form-group">
          <form action="/register" method="post">
              <div class="form-group">
                  <input autocomplete="off" autofocus class="form-control" name="username" placeholder="Username" type="text">
              </div>
              <div class="form-group">
                <input class="form-control" name="password" placeholder="Password" type="password">
              </div>
              <div class="form-group">
                  <input class="form-control" name="confirmation" placeholder="Please type your password again" type="password">
              </div>
              <button class="btn btn-primary" type="submit">Register</button>
          </form>
        </div>
      </div>
    </div>

    <script>
    document.querySelector('form').onsubmit = function(e) {
        e.preventDefault();
        $.get("/check", {username: document.querySelector('input[name = username]').value}, function(response){
            if(response){
                document.querySelector('form').submit();
            }
            else{
                //alert("That username is already in use!");
                bootbox.alert({
                    message: "That username is already in use",
                    backdrop: true,
                    size: "small"
                });
            }
        });
    };
    </script>
{% endblock %}
